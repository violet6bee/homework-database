Описание проекта: Структура базы данных предназначена для управления информацией о гостиницах, номерах, клиентах и бронированиях. Она состоит из четырех таблиц: Hotel, Room, Customer и Booking.

Таблица Room ссылается на таблицу Hotel, обеспечивая связь между номерами и соответствующими гостиницами. 
Таблица Booking связывает номера и клиентов, обеспечивая информацию о том, какие номера были забронированы конкретными клиентами.
Использование внешних ключей (в Room и Booking) поддерживает целостность данных, гарантируя, что все ссылки на гостиницы, номера и клиентов верны.

Данная структура базы данных эффективно организует и систематизирует информацию о гостиницах, номерах, клиентах и их бронированиях. Это позволяет удобно управлять данными, обеспечивая целостность информации и легкость доступа к различным аспектам гостиничного сервиса.

1. Создадим БД hotels.
2. Создадим таблицы, запустив скрипт из файла Databases/Hotels/create_tables.sql.
3. Наполним таблицы данными с помощью скрипта Databases/Hotels/insert_data.sql.

Задача 1.
Условие

Определить, какие клиенты сделали более двух бронирований в разных отелях, и вывести информацию о каждом таком клиенте, включая его имя, электронную почту, телефон, общее количество бронирований, а также список отелей, в которых они бронировали номера (объединенные в одно поле через запятую с помощью CONCAT). Также подсчитать среднюю длительность их пребывания (в днях) по всем бронированиям. Отсортировать результаты по количеству бронирований в порядке убывания.

Решение:
Размещено в скрипте Databases/Hotels/task1.sql.

Задача 2.
Условие

Необходимо провести анализ клиентов, которые сделали более двух бронирований в разных отелях и потратили более 500 долларов на свои бронирования. Для этого:

Определить клиентов, которые сделали более двух бронирований и забронировали номера в более чем одном отеле. Вывести для каждого такого клиента следующие данные: ID_customer, имя, общее количество бронирований, общее количество уникальных отелей, в которых они бронировали номера, и общую сумму, потраченную на бронирования.
Также определить клиентов, которые потратили более 500 долларов на бронирования, и вывести для них ID_customer, имя, общую сумму, потраченную на бронирования, и общее количество бронирований.
В результате объединить данные из первых двух пунктов, чтобы получить список клиентов, которые соответствуют условиям обоих запросов. Отобразить поля: ID_customer, имя, общее количество бронирований, общую сумму, потраченную на бронирования, и общее количество уникальных отелей.
Результаты отсортировать по общей сумме, потраченной клиентами, в порядке возрастания.

Решение:
Размещено в скрипте Databases/Hotels/task2.sql.

Задача 3.
Условие

Вам необходимо провести анализ данных о бронированиях в отелях и определить предпочтения клиентов по типу отелей. Для этого выполните следующие шаги:

Категоризация отелей.
Определите категорию каждого отеля на основе средней стоимости номера:

«Дешевый»: средняя стоимость менее 175 долларов.
«Средний»: средняя стоимость от 175 до 300 долларов.
«Дорогой»: средняя стоимость более 300 долларов.
Анализ предпочтений клиентов.
Для каждого клиента определите предпочитаемый тип отеля на основании условия ниже:

Если у клиента есть хотя бы один «дорогой» отель, присвойте ему категорию «дорогой».
Если у клиента нет «дорогих» отелей, но есть хотя бы один «средний», присвойте ему категорию «средний».
Если у клиента нет «дорогих» и «средних» отелей, но есть «дешевые», присвойте ему категорию предпочитаемых отелей «дешевый».
Вывод информации.
Выведите для каждого клиента следующую информацию:

ID_customer: уникальный идентификатор клиента.
name: имя клиента.
preferred_hotel_type: предпочитаемый тип отеля.
visited_hotels: список уникальных отелей, которые посетил клиент.
Сортировка результатов.
Отсортируйте клиентов так, чтобы сначала шли клиенты с «дешевыми» отелями, затем со «средними» и в конце — с «дорогими».

Решение:
Размещено в скрипте Databases/Hotels/task3.sql.
